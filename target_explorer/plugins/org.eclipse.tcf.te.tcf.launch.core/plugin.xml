<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>

<!-- Adapter factory contributions -->
   <extension point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="org.eclipse.debug.core.ILaunch"
            class="org.eclipse.tcf.te.tcf.launch.core.internal.adapters.AdapterFactory">
         <adapter type="org.eclipse.tcf.te.runtime.stepper.interfaces.IStepContext"/>
      </factory>
   </extension>

<!-- Service contributions -->
   <extension point="org.eclipse.tcf.te.runtime.services.services">
      <service
            class="org.eclipse.tcf.te.tcf.launch.core.services.DebugService"
            id="org.eclipse.tcf.te.tcf.launch.core.services.debug">
         <serviceType
               bundleId="org.eclipse.tcf.te.runtime.services"
               class="org.eclipse.tcf.te.runtime.services.interfaces.IDebugService">
         </serviceType>
         <enablement>
            <or>
               <instanceof value="org.eclipse.tcf.te.tcf.locator.interfaces.nodes.IPeerModel"/>
               <instanceof value="org.eclipse.tcf.protocol.IPeer"/>
            </or>   
         </enablement>
      </service>
   </extension>

<!-- Launch Configuration Type contributions -->
   <extension point="org.eclipse.debug.core.launchConfigurationTypes">
      <launchConfigurationType
            delegate="org.eclipse.tcf.te.launch.core.delegates.LaunchConfigurationDelegate"
            id="org.eclipse.tcf.te.tcf.launch.type.remote.app"
            modes="run,debug"
            name="%LaunchType.Remote.App.name">
      </launchConfigurationType>
   </extension>
   
<!-- Launch Configuration Type Binding contributions -->
   <extension point="org.eclipse.tcf.te.launch.core.launchConfigTypeBindings">
      <launchConfigTypeBinding
            launchConfigTypeId="org.eclipse.tcf.te.tcf.launch.type.remote.app">
         <launchManagerDelegate
               id="org.eclipse.tcf.te.tcf.launch.type.remote.app.launchManagerDelegate"
               modes="run,debug">
         </launchManagerDelegate>
         <stepGroup
               id="org.eclipse.tcf.te.tcf.launch.type.remote.app.stepGroup"
               modes="run,debug">
         </stepGroup>
      </launchConfigTypeBinding>
   </extension>
   
<!-- Launch Manager Delegate contributions -->
   <extension point="org.eclipse.tcf.te.launch.core.launchManagerDelegates">
      <delegate
            class="org.eclipse.tcf.te.tcf.launch.core.lm.delegates.RemoteAppLaunchManagerDelegate"
            id="org.eclipse.tcf.te.tcf.launch.type.remote.app.launchManagerDelegate">
      </delegate>
   </extension>
   
<!-- Launch Step Group contributions -->
   <extension point="org.eclipse.tcf.te.runtime.stepper.stepGroups">
      <stepGroup
            id="org.eclipse.tcf.te.tcf.launch.type.remote.app.stepGroup"
            label="%LaunchStepGroup.Remote.App.name"
            locked="false">
         <references>
            <reference id="org.eclipse.tcf.te.tcf.launch.core.openChannelStep"/>
            <reference id="org.eclipse.tcf.te.tcf.launch.core.launchProcessStep"/>
            <reference id="org.eclipse.tcf.te.tcf.launch.core.closeChannelStep"/>
            <reference id="org.eclipse.tcf.te.launch.core.removeLaunchStep">
               <enablement>
                  <with variable="context">
                     <not>
                        <test property="org.eclipse.tcf.te.launch.core.launchMode" value="debug"/>
                     </not>
                  </with>
               </enablement>
            </reference>
         </references>
      </stepGroup>
   </extension>
   
<!-- Launch Step contributions -->
   <extension point="org.eclipse.tcf.te.runtime.stepper.steps">
      <step
            class="org.eclipse.tcf.te.tcf.launch.core.steps.OpenChannelStep"
            id="org.eclipse.tcf.te.tcf.launch.core.openChannelStep"
            label="%LaunchStep.OpenChannel.name">
      </step>
      <step
            class="org.eclipse.tcf.te.tcf.launch.core.steps.LaunchProcessStep"
            id="org.eclipse.tcf.te.tcf.launch.core.launchProcessStep"
            label="%LaunchStep.LaunchProcess.name">
         <requires
               id="org.eclipse.tcf.te.tcf.launch.core.openChannelStep">
         </requires>
      </step>
      <step
            class="org.eclipse.tcf.te.tcf.launch.core.steps.CloseChannelStep"
            id="org.eclipse.tcf.te.tcf.launch.core.closeChannelStep"
            label="%LaunchStep.CloseChannel.name">
         <requires
               id="org.eclipse.tcf.te.tcf.launch.core.openChannelStep">
         </requires>
      </step>
   </extension>

<!-- Persistence delegate contributions -->
   <extension point="org.eclipse.tcf.te.runtime.persistence.delegates">
      <delegate 
            id="org.eclipse.tcf.te.tcf.launch.core.persistence.fileTransferToString"
            class="org.eclipse.tcf.te.tcf.launch.core.internal.FileTransferItemToStringPersistenceDelegate">
      </delegate>
      <delegate 
            id="org.eclipse.tcf.te.tcf.launch.core.persistence.referencedProjectToString"
            class="org.eclipse.tcf.te.tcf.launch.core.internal.ReferencedProjectItemToStringPersistenceDelegate">
      </delegate>
   </extension>

<!-- Persistence delegate bindings contributions -->
   <extension point="org.eclipse.tcf.te.runtime.persistence.bindings">
       <binding
            delegateId="org.eclipse.tcf.te.tcf.launch.core.persistence.fileTransferToString"
            id="org.eclipse.tcf.te.tcf.launch.core.binding.fileTransferToString">
         <enablement>
            <with variable="container">
               <or>
                  <instanceof value="java.lang.String"/>
                  <and>
                     <instanceof value="java.lang.Class"/>
                     <with variable="containerClass">
                        <equals value="java.lang.String"/>
                     </with>
                  </and>
               </or>
            </with>
            <with variable="context">
               <or>
                  <instanceof value="org.eclipse.tcf.te.launch.core.interfaces.IFileTransferItem"/>
                  <and>
                     <instanceof value="java.lang.Class"/>
                     <with variable="contextClass">
                        <equals value="org.eclipse.tcf.te.launch.core.interfaces.IFileTransferItem"/>
                     </with>
                  </and>
               </or>
            </with>
         </enablement>
      </binding>
       <binding
            delegateId="org.eclipse.tcf.te.tcf.launch.core.persistence.referencedProjectToString"
            id="org.eclipse.tcf.te.tcf.launch.core.binding.referencedProjectToString">
         <enablement>
            <with variable="container">
               <or>
                  <instanceof value="java.lang.String"/>
                  <and>
                     <instanceof value="java.lang.Class"/>
                     <with variable="containerClass">
                        <equals value="java.lang.String"/>
                     </with>
                  </and>
               </or>
            </with>
            <with variable="context">
               <or>
                  <instanceof value="org.eclipse.tcf.te.launch.core.interfaces.IReferencedProjectItem"/>
                  <and>
                     <instanceof value="java.lang.Class"/>
                     <with variable="contextClass">
                        <equals value="org.eclipse.tcf.te.launch.core.interfaces.IReferencedProjectItem"/>
                     </with>
                  </and>
               </or>
            </with>
         </enablement>
      </binding>
   </extension>

</plugin>
