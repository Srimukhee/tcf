<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?><!--
    Copyright (c) 2010 Wind River Systems, Inc. and others.
    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License v1.0
    which accompanies this distribution, and is available at
    http://www.eclipse.org/legal/epl-v10.html
   
    Contributors:
        Wind River Systems - initial API and implementation
 -->

<plugin>

   <extension-point id="launch_context" name="TCF Launch Context" schema="schema/launch_context.exsd"/>

   <extension point="org.eclipse.tm.tcf.startup"/>

   <extension
        id="org.eclipse.tm.tcf.debug.ui.adapters"
        point="org.eclipse.core.runtime.adapters">
      <factory 
         class="org.eclipse.tm.internal.tcf.debug.ui.adapters.TCFLaunchAdapterFactory" 
         adaptableType="org.eclipse.tm.internal.tcf.debug.model.TCFLaunch">
         <adapter type="org.eclipse.debug.internal.ui.viewers.model.provisional.IElementContentProvider"/>
         <adapter type="org.eclipse.debug.internal.ui.viewers.model.provisional.IElementLabelProvider"/>
         <adapter type="org.eclipse.debug.internal.ui.viewers.model.provisional.IModelProxyFactory"/>
         <adapter type="org.eclipse.debug.ui.contexts.ISuspendTrigger"/>
      </factory>
      <factory
         class="org.eclipse.tm.internal.tcf.debug.ui.adapters.TCFNodeAdapterFactory"
         adaptableType="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
         <adapter type="org.eclipse.debug.ui.actions.IToggleBreakpointsTarget"/>
         <adapter type="org.eclipse.debug.ui.actions.IToggleBreakpointsTargetExtension"/>
      </factory>
   </extension>
   
   <extension point="org.eclipse.debug.ui.debugModelPresentations">
      <debugModelPresentation 
         class = "org.eclipse.tm.internal.tcf.debug.ui.model.TCFModelPresentation"
         id = "org.eclipse.tm.tcf.debug">
      </debugModelPresentation>
   </extension>
   
   <extension point="org.eclipse.debug.ui.launchConfigurationTypeImages">
      <launchConfigurationTypeImage
            icon="icons/tcf.gif"
            configTypeID="org.eclipse.tm.tcf.debug.LaunchConfigurationType"
            id="org.eclipse.tm.tcf.debug.LaunchConfigurationTypeImage">
      </launchConfigurationTypeImage>
   </extension>
   
   <extension point="org.eclipse.debug.ui.launchConfigurationTabGroups">
      <launchConfigurationTabGroup
            type="org.eclipse.tm.tcf.debug.LaunchConfigurationType"
            description="Run or debug a program using Target Communication Framework"
            class="org.eclipse.tm.internal.tcf.debug.ui.launch.TCFTabGroup"
            id="org.eclipse.tm.tcf.debug.LaunchConfigurationTabGroup">
      </launchConfigurationTabGroup>
   </extension>
   
   <extension point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
      		namespace="org.eclipse.tm.tcf.launch"
            properties="isExecutable"
            type="org.eclipse.core.runtime.IAdaptable"
            class="org.eclipse.tm.internal.tcf.debug.ui.launch.TCFPropertyTester"
            id="org.eclipse.tm.tcf.launch.PropertyTester">
      </propertyTester>
   </extension>

   <extension point="org.eclipse.debug.ui.launchShortcuts">
      <shortcut
         label="TCF Application"
         icon="icons/tcf.gif"
         helpContextId="org.eclipse.tm.tcf.debug.ui.shortcut_tcf_application"
         modes="run, debug"
         class="org.eclipse.tm.internal.tcf.debug.ui.launch.TCFLaunchShortcut"
         description="Launch an application using Target Communication Framework (TCF)"
         id="org.eclipse.tm.tcf.debug.ui.TCFShortcut">
         <description
            description="Runs an application using Target Communication Framework (TCF)"
            mode="run">
         </description>
         <description
            description="Debugs an application using Target Communication Framework (TCF)"
            mode="debug">
         </description>
         <contextualLaunch>
            <enablement>
               <with variable="selection">
                  <count value="1"/>
                  <iterate>
                     <test
                        forcePluginActivation="true"
                        property="org.eclipse.tm.tcf.launch.isExecutable"/>
                  </iterate>
               </with>
            </enablement>
         </contextualLaunch>
         <configurationType
            id="org.eclipse.tm.tcf.debug.LaunchConfigurationType">
         </configurationType>
      </shortcut>
   </extension>

   <extension
         point="org.eclipse.ui.contexts">
      <context
            name="Debugging using Target Communication Framework"
            description="Debugging using Target Communication Framework"
            id="org.eclipse.tm.tcf.debug.ui.debugging"
            parentId="org.eclipse.debug.ui.debugging">
      </context>
   </extension>

   <extension
         point="org.eclipse.ui.views">
      <view
            name="TCF Trace"
            icon="icons/tcf.gif"
            category="org.eclipse.debug.ui"
            class="org.eclipse.tm.internal.tcf.debug.ui.trace.TraceView"
            id="org.eclipse.tm.tcf.TraceView">
      </view>
   </extension>

   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.eclipse.debug.ui.DebugPerspective">
         <view
               relative="org.eclipse.ui.console.ConsoleView"
               relationship="stack"
               visible="false"
               id="org.eclipse.tm.tcf.TraceView">
         </view>
      </perspectiveExtension>
   </extension>
   
   <extension point="org.eclipse.ui.editors.annotationTypes">
      <type
         name="org.eclipse.tm.tcf.debug.top_frame">
      </type>
      <type
         name="org.eclipse.tm.tcf.debug.stack_frame">
      </type>
   </extension>  
   
   <extension point="org.eclipse.ui.editors.markerAnnotationSpecification">
      <specification
         annotationImageProvider="org.eclipse.tm.internal.tcf.debug.ui.model.TCFAnnotationImageProvider"
         annotationType="org.eclipse.tm.tcf.debug.top_frame"
         colorPreferenceKey="currentIPColor"
         colorPreferenceValue="198,219,174"
         highlightPreferenceKey="currentIPHighlight"
         highlightPreferenceValue="true"
         label="%debugCurrentInstructionPointer"
         overviewRulerPreferenceKey="currentIPOverviewRuler"
         overviewRulerPreferenceValue="true"
         presentationLayer="6"
         textPreferenceKey="currentIPIndication"
         textPreferenceValue="false"
         verticalRulerPreferenceKey="currentIPVerticalRuler"
         verticalRulerPreferenceValue="true">
      </specification>
      <specification
         annotationImageProvider="org.eclipse.tm.internal.tcf.debug.ui.model.TCFAnnotationImageProvider"
         annotationType="org.eclipse.tm.tcf.debug.stack_frame"
         colorPreferenceKey="secondaryIPColor"
         colorPreferenceValue="219,235,204"
         highlightPreferenceKey="secondaryIPHighlight"
         highlightPreferenceValue="true"
         label="%debugCallStack"
         overviewRulerPreferenceKey="secondaryIPOverviewRuler"
         overviewRulerPreferenceValue="true"
         presentationLayer="6"
         textPreferenceKey="secondaryIPIndication"
         textPreferenceValue="false"
         verticalRulerPreferenceKey="secondaryIPVerticalRuler"
         verticalRulerPreferenceValue="true">
      </specification>
   </extension>

   <extension point="org.eclipse.debug.ui.detailPaneFactories">
      <detailFactories
             class="org.eclipse.tm.internal.tcf.debug.ui.model.TCFDetailPaneFactory"
             id="org.eclipse.tm.tcf.debug.DetailPaneFactory">
         <enablement>
            <with variable="selection">
               <iterate>
                  <or>
                     <instanceof value="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode"/>
                  </or>
               </iterate>
            </with>
         </enablement>                   
      </detailFactories>
   </extension>
    
   <extension point="org.eclipse.ui.popupMenus">
      <!-- TCFLaunch popup menu contributions -->
      <objectContribution
            id="org.eclipse.tm.tcf.debug.ui.TCFLaunch"
            objectClass="org.eclipse.tm.internal.tcf.debug.model.TCFLaunch">
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.Signals"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.Signals"
            icon="icons/signals.gif"
            label="%Signals.label"
            menubarPath="additions">
         </action>
      </objectContribution>

      <!-- TCFNode popup menu contributions -->
      <objectContribution
            id="org.eclipse.tm.tcf.debug.ui.TCFNode"
            objectClass="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.Signals"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.Signals"
            icon="icons/signals.gif"
            label="%Signals.label"
            menubarPath="additions">
         </action>
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.MemoryMap"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.MemoryMap"
            icon="icons/memory-map.gif"
            label="%MemoryMap.label"
            menubarPath="additions">
         </action>
      </objectContribution>
      
      <!-- ICastToType popup menu contributions -->
      <objectContribution
            id="org.eclipse.tm.tcf.debug.ui.CastToType"
            objectClass="org.eclipse.tm.internal.tcf.debug.ui.model.ICastToType">
         <action
               label="%RestoreDefaultType.label"
               helpContextId="restore_default_type_action_context"
               tooltip="%RestoreDefaultType.tooltip"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.RestoreDefaultType"
               menubarPath="variableGroup"
               enablesFor="1"
               id="org.eclipse.tm.tcf.debug.ui.commands.RestoreDefaultType">
            <enablement>
               <pluginState
                     value="activated"
                     id="org.eclipse.tm.tcf.debug.ui">
               </pluginState>
            </enablement>
         </action>
         <action
               label="%CastToType.label"
               icon="icons/casttotype_co.gif"
               helpContextId="cast_to_type_action_context"
               tooltip="%CastToType.tooltip"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.CastToType"
               menubarPath="variableGroup"
               enablesFor="1"
               id="org.eclipse.tm.tcf.debug.ui.commands.CastToType">
            <enablement>
               <pluginState
                     value="activated"
                     id="org.eclipse.tm.tcf.debug.ui">
               </pluginState>
            </enablement>
         </action>
         <action
               label="%CastToArray.label"
               icon="icons/showasarray_co.gif"
               helpContextId="cast_to_array_action_context"
               tooltip="%CastToArray.tooltip"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.CastToArray"
               menubarPath="variableGroup"
               enablesFor="1"
               id="org.eclipse.tm.tcf.debug.ui.commands.CastToArray">
            <enablement>
               <pluginState
                     value="activated"
                     id="org.eclipse.tm.tcf.debug.ui">
               </pluginState>
            </enablement>
         </action>
      </objectContribution>
      
      <!-- Reverse run control popup menu contributions -->
      <objectContribution
            id="org.eclipse.tm.tcf.debug.ui.TCFNode"
            objectClass="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.BackInto"
            definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackInto"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackIntoActionDelegate"
            icon="icons/e16/back_into.gif"
            label="%BackInto.label"
            menubarPath="stepIntoGroup">
         </action>
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.BackOver"
            definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackOver"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackOverActionDelegate"
            icon="icons/e16/back_over.gif"
            label="%BackOver.label"
            menubarPath="stepOverGroup">
         </action>
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.BackReturn"
            definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackReturn"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackReturnActionDelegate"
            icon="icons/e16/back_out.gif"
            label="%BackReturn.label"
            menubarPath="stepReturnGroup">
         </action>
         <action
            id="org.eclipse.tm.tcf.debug.ui.actions.BackResume"
            definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackResume"
            class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackResumeActionDelegate"
            icon="icons/e16/back_run.gif"
            label="%BackResume.label"
            menubarPath="threadGroup">
         </action>
      </objectContribution>
   </extension>
   
   <!-- TODO: Reverse run control UI contributions need to be placed in a shared plugin -->
   <!-- Reverse run control actions --> 
   <extension
         point="org.eclipse.ui.viewActions">
      <viewContribution
            targetID="org.eclipse.debug.ui.DebugView"
            id="org.eclipse.tm.tcf.debug.ui.DebugView">
         <action
               id="org.eclipse.tm.tcf.debug.ui.actions.BackInto"
               definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackInto"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackIntoActionDelegate"
               icon="icons/e16/back_into.gif"
               disabledIcon="icons/d16/back_into.gif"
               toolbarPath="stepIntoGroup"
               label="%BackInto.label"
               tooltip="%BackInto.tooltip"
               enablesFor="+"
               >
               <selection
                   class="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
               </selection>
         </action>
         <action
               id="org.eclipse.tm.tcf.debug.ui.actions.BackOver"
               definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackOver"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackOverActionDelegate"
               icon="icons/e16/back_over.gif"
               disabledIcon="icons/d16/back_over.gif"
               toolbarPath="stepOverGroup"
               label="%BackOver.label"
               tooltip="%BackOver.tooltip"
               enablesFor="+"
               >
               <selection
                   class="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
               </selection>
         </action>
         <action
               id="org.eclipse.tm.tcf.debug.ui.actions.BackReturn"
               definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackReturn"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackReturnActionDelegate"
               icon="icons/e16/back_out.gif"
               disabledIcon="icons/d16/back_out.gif"
               toolbarPath="stepReturnGroup"
               label="%BackReturn.label"
               tooltip="%BackReturn.tooltip"
               enablesFor="+"
               >
               <selection
                   class="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
               </selection>
         </action>
         <action
               id="org.eclipse.tm.tcf.debug.ui.actions.BackResume"
               definitionId="org.eclipse.tm.tcf.debug.ui.commands.BackResume"
               class="org.eclipse.tm.internal.tcf.debug.ui.commands.BackResumeActionDelegate"
               icon="icons/e16/back_run.gif"
               disabledIcon="icons/d16/back_run.gif"
               toolbarPath="threadGroup"
               label="%BackResume.label"
               tooltip="%BackResume.tooltip"
               enablesFor="+"
               >
               <selection
                   class="org.eclipse.tm.internal.tcf.debug.ui.model.TCFNode">
               </selection>
         </action>
      </viewContribution>
   </extension>
   
   <extension
         point="org.eclipse.ui.commands">
      <category
            name="%ReverseExecutionCategory.name"
            description="%ReverseExecutionCategory.description"
            id="org.eclipse.tm.tcf.debug.ui.ReverseExecution">
      </category>
      <command
            name="%BackInto.label"
            categoryId="org.eclipse.tm.tcf.debug.ui.ReverseExecution"
            description="%BackInto.description"
            id="org.eclipse.tm.tcf.debug.ui.commands.BackInto">
      </command>
      <command
            name="%BackOver.label"
            categoryId="org.eclipse.tm.tcf.debug.ui.ReverseExecution"
            description="%BackOver.description"
            id="org.eclipse.tm.tcf.debug.ui.commands.BackOver">
      </command>
      <command
            name="%BackReturn.label"
            categoryId="org.eclipse.tm.tcf.debug.ui.ReverseExecution"
            description="%BackReturn.description"
            id="org.eclipse.tm.tcf.debug.ui.commands.BackReturn">
      </command>
      <command
            name="%BackResume.label"
            categoryId="org.eclipse.tm.tcf.debug.ui.ReverseExecution"
            description="%BackResume.description"
            id="org.eclipse.tm.tcf.debug.ui.commands.BackResume">
      </command>
   </extension>
     
   <extension point="org.eclipse.ui.bindings">
      <key
            sequence="M2+F5"
            contextId="org.eclipse.debug.ui.debugging"
            commandId="org.eclipse.tm.tcf.debug.ui.commands.BackInto"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"/>
      <key
            sequence="M2+F6"
            contextId="org.eclipse.debug.ui.debugging"
            commandId="org.eclipse.tm.tcf.debug.ui.commands.BackOver"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"/>
      <key
            sequence="M2+F7"
            contextId="org.eclipse.debug.ui.debugging"
            commandId="org.eclipse.tm.tcf.debug.ui.commands.BackReturn"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"/>
      <key
            sequence="M2+F8"
            contextId="org.eclipse.debug.ui.debugging"
            commandId="org.eclipse.tm.tcf.debug.ui.commands.BackResume"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"/>
   </extension>

   <extension
         point="org.eclipse.debug.ui.memoryRenderings">
      <renderingBindings
            defaultIds="org.eclipse.debug.ui.rendering.raw_memory"
            primaryId="org.eclipse.debug.ui.rendering.raw_memory"
            renderingIds="org.eclipse.debug.ui.rendering.raw_memory,org.eclipse.debug.ui.rendering.ascii,org.eclipse.debug.ui.rendering.signedint,org.eclipse.debug.ui.rendering.unsignedint,org.eclipse.debug.ui.rendering.hexint">
         <enablement>
            <instanceof value="org.eclipse.tm.internal.tcf.debug.ui.model.TCFMemoryBlockRetrieval$MemoryBlock"/>
         </enablement>
      </renderingBindings>
   </extension>
   
</plugin>
